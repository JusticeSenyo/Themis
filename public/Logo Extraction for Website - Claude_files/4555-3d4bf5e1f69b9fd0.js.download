"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4555],{34555:function(e,t,n){n.d(t,{CodeRenderer:function(){return P},B:function(){return k},MarkdownRenderer:function(){return T}});var o=n(27573),a=n(61995),r=n(2210),s=n(405),i=n(20147),l=n(39527),c=n(82083),d=n(96707),u=n(10607),p=n(7653),h=n(41668),m=n(84575),g=n(70354),f=n(1133),x=n(97417),y=n(39975),b=n(64357),v=n(46272),C=n(40950),S=n(45790);let w=e=>{let{isStreaming:t,children:n,...a}=e;return t?n:(0,o.jsx)(z,{...a,children:n})},z=e=>{let{children:t,sendMessage:n,contentType:a="text",isOpen:r}=e,s=(0,C.Z)(),i=void 0!==n,[l,c]=(0,p.useState)([]),[d,h]=(0,p.useState)({top:0,left:0,width:0}),[w,z]=(0,p.useState)(!1),[R,j]=(0,p.useState)(!1),[M,q]=(0,p.useState)(""),[E,k]=(0,p.useState)(""),[P,T]=(0,p.useState)(!1),O=(0,p.useRef)(null),F=(0,p.useRef)(null),N=(0,p.useCallback)((e,t)=>{var n;let o=function(e,t){let n=[];for(let o=0;o<e.rangeCount;o++){let a=e.getRangeAt(o);if(a.startContainer===a.endContainer&&a.startContainer.nodeType===Node.TEXT_NODE){let e=a.startContainer,t=document.createRange();for(let o=a.startOffset;o<a.endOffset;o++){t.setStart(e,o),t.setEnd(e,o+1);let a=Array.from(t.getClientRects());n.push(...a)}t.detach()}else{let e=function(e){let t;let n=[],o=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_TEXT,t=>e.intersectsNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);for(;t=o.nextNode();)n.push(t);return n}(a);e.forEach((o,r)=>{let s=document.createRange(),i="length"in o?o.length:0,l=0===r,c=r===e.length-1,d=l?a.startOffset:0,u=c&&!t?a.endOffset:i;s.setStart(o,d),s.setEnd(o,u);let p=Array.from(s.getClientRects());n.push(...p),s.detach()})}}return n}(e,t),a=null===(n=O.current)||void 0===n?void 0:n.getBoundingClientRect();return Array.from(o).map(e=>({top:e.top-((null==a?void 0:a.top)||0)-2.5,left:e.left-((null==a?void 0:a.left)||0),width:e.width,height:e.height+5.5}))},[]),I=(0,p.useCallback)(e=>{var t;let n=e.getRangeAt(0);return null===(t=O.current)||void 0===t?void 0:t.contains(n.commonAncestorContainer)},[]);(0,p.useEffect)(()=>{function e(e){var t,n,o,a;let r,s,{selection:i,isSelectAll:l}=e,d=N(i,l);if(d.every((e,t,n)=>0===t||5>Math.abs(e.top-n[0].top))){let e=Math.max(...d.map(e=>e.left+e.width));r=d[0].top-9,s=e+10}else{let e=Math.max(...d.map(e=>e.top+e.height));s=Math.min(...d.map(e=>e.left)),r=Math.min((null!==(o=null===(n=O.current)||void 0===n?void 0:n.scrollHeight)&&void 0!==o?o:0)-50,e)}let u=((null!==(a=null===(t=O.current)||void 0===t?void 0:t.scrollWidth)&&void 0!==a?a:1e3)-s)/3*2;c(d),z(!0),j(!1),h({top:r,left:s,width:u}),k(i.toString())}let t=()=>{T(!0)},n=t=>{"Escape"===t.key&&(j(!1),z(!1),q(""),c([]));let n=((0,f.V5)()?t.metaKey:t.ctrlKey)&&"a"===t.key,o=O.current;if(o&&r&&n){let n=document.activeElement&&(document.activeElement===o||(null==o?void 0:o.contains(document.activeElement))),a=window.getSelection();if(n&&a){t.preventDefault();let n=document.createRange();n.selectNodeContents(o),a.removeAllRanges(),a.addRange(n),e({selection:a,isSelectAll:!0})}}},o=t=>{if(F.current&&F.current.contains(t.target))return;let n=window.getSelection();n&&!n.isCollapsed&&I(n)?e({selection:n}):(c([]),z(!1),j(!1),k(""),q("")),T(!1)};return i&&(document.addEventListener("mousedown",t),document.addEventListener("mouseup",o),document.addEventListener("keydown",n)),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("mouseup",o),document.removeEventListener("keydown",n)}},[N,I,i,r]);let A=e=>{i&&(n(e),q(""),j(!1),z(!1),c([]))},L=()=>"text"===a?E.split("\n").map(e=>"> ".concat(e)).join("\n"):"code"===a?"```\n".concat(E,"\n```"):void 0,G=()=>{A({prompt:"".concat(L(),"\n\n").concat(M),attachments:[],files:[],syncSources:[]})};return(0,o.jsxs)("div",{className:"w-full h-full relative",children:[(0,o.jsx)("div",{ref:O,tabIndex:0,className:(0,u.W)("w-full h-full relative",i?P?"[&_:not(input)::selection]:bg-secondary-000/10":"[&_*::selection]:bg-secondary-000/10":""),children:t}),l.map((e,t)=>(0,o.jsx)("div",{className:"absolute pointer-events-none bg-accent-secondary-000/10",style:{top:e.top,left:e.left,width:e.width,height:e.height}},t)),(0,o.jsx)(b.M,{children:w&&!R&&(0,o.jsx)(v.E.div,{className:"absolute z-10",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:30,stiffness:400,delay:.2},style:{top:d.top+5,left:d.left},children:(0,o.jsx)("div",{className:"border-0.5 flex items-center rounded-lg px-2 pb-1 pt-3 shadow transition bg-bg-000 text-text-400 border-border-300",children:(0,o.jsxs)("div",{className:"-mx-1 -mt-2 flex items-stretch justify-between gap-0.5",children:[(0,o.jsxs)(m.w,{onClick:()=>{j(!0)},isAssistant:!0,children:[(0,o.jsx)(x.A,{size:16}),(0,o.jsx)(S.Z,{defaultMessage:"Improve",id:"BATKcMm/a2"})]}),(0,o.jsxs)(m.w,{onClick:()=>{A({prompt:"".concat(s.formatMessage({defaultMessage:"Can you explain this section to me in more detail?",id:"LMDbiRxyDQ"}),"\n\n").concat(L()),attachments:[],files:[],syncSources:[]})},isAssistant:!0,children:[(0,o.jsx)(y.v,{size:16}),(0,o.jsx)(S.Z,{defaultMessage:"Explain",id:"HGdgPPM2Ry"})]})]})})})}),(0,o.jsx)(b.M,{children:R&&(0,o.jsxs)(v.E.form,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{type:"spring",damping:30,stiffness:400},className:"z-10 absolute flex gap-2 p-2 pl-4 items-center h-12 rounded-lg bg-bg-000 text-text-200 border border-0.5 border-border-300 shadow-xl",style:{top:d.top+5,left:d.left,width:d.width},ref:F,onSubmit:e=>{e.preventDefault(),G()},children:[(0,o.jsx)("input",{type:"text",value:M,onChange:e=>q(e.target.value),placeholder:s.formatMessage({defaultMessage:"Describe what you would like to update...",id:"smio7jldoW"}),className:"py-0.5 px-0 border-0 bg-transparent text-sm grow !shadow-none text-text-200 placeholder-text-500 hide-focus-ring",autoFocus:!0}),(0,o.jsx)(b.M,{children:M.trim().length>0?(0,o.jsx)(v.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:30,stiffness:400,delay:0},children:(0,o.jsx)(g.z,{onClick:()=>G(),"aria-label":s.formatMessage({defaultMessage:"Send Message",id:"yJAKR0Ngpn"}),type:"submit",children:(0,o.jsx)("div",{className:"flex items-center gap-2 select-none",children:(0,o.jsx)(S.Z,{defaultMessage:"Update",id:"BWpuKlRSA1"})})})}):null})]})})]})};var R=n(49717);let j=e=>{let{handleClose:t,title:n,description:a,inset:r,action:s}=e;return(0,o.jsxs)("div",{className:"border-border-300 shadow-sm w-[300px] max-w-full bg-bg-000 rounded-xl p-5 border relative",children:[(0,o.jsx)("div",{className:"text-left mb-2 font-medium text-sm",children:n}),(0,o.jsx)("p",{className:"mb-2 text-sm",children:a}),!!r&&(0,o.jsx)("div",{className:"flex flex-col rounded-md bg-text-000 bg-opacity-5 p-4 font-mono text-xs text-text-300",children:r}),s&&(0,o.jsx)("div",{className:"flex justify-end",children:(0,o.jsx)(g.z,{variant:"primary",className:"mt-4 text-sm",onClick:s.onClick,disabled:s.disabled,loading:s.loading,children:s.label})}),(0,o.jsx)("div",{className:"absolute top-2 right-2",children:(0,o.jsx)(g.z,{variant:"ghost",onClick:t,className:"h-9 w-9 !min-w-9",children:(0,o.jsx)(R.X,{})})})]})},M=e=>{var t,n,a;let{error:r,handleClose:s,sendMessage:i,isStreaming:l}=e,[c,d]=(0,p.useState)(!1),u=(0,C.Z)(),h=function(e,t){switch(e.type){case"UnsupportedImports":return{title:t?t.formatMessage({defaultMessage:"Artifact failed to load",id:"NcDXiSfIPe"}):"Artifact failed to load",description:t?t.formatMessage({defaultMessage:"The generated artifact uses libraries we don’t support:",id:"HG0Hu8xIQA"}):"The generated artifact uses libraries we don’t support:",inset:[...e.unsupportedModules,...e.nonExistentIcons.map(e=>"{ ".concat(e,' } from "lucide-react"'))],subtext:t?t.formatMessage({defaultMessage:"The code itself may still work. To use it, you’ll need a development setup with these libraries installed.",id:"Et/uvuRBba"}):"The code itself may still work. To use it, you’ll need a development setup with these libraries installed."};case"RuntimeError":return{title:t?t.formatMessage({defaultMessage:"Error running artifact",id:"JU2kK1J3jY"}):"Error running artifact",description:t?t.formatMessage({defaultMessage:"An error occurred while trying to run the generated artifact.",id:"3RpkNRAyPc"}):"An error occurred while trying to run the generated artifact.",inset:[e.message],insetStyle:"danger"};case"FileNotFound":return{title:t?t.formatMessage({defaultMessage:"File not found",id:"gcaJtRf4b0"}):"File not found",description:t?t.formatMessage({defaultMessage:"The file “{fileName}” could not be found.",id:"0kOCGtB3eN"},{fileName:e.fileName}):"The file “".concat(e.fileName,"” could not be found."),subtext:t?t.formatMessage({defaultMessage:"Please check the file name and try again.",id:"/fdYJU5SMC"}):"Please check the file name and try again."};case"ClaudeCompletionError":return{title:t?t.formatMessage({defaultMessage:"Error in Claude completion",id:"ya5HK9oB9T"}):"Error in Claude completion",description:e.message}}}(r.error,u),m="> ".concat(h.description,"\n  ").concat(null!==(a=null===(t=h.inset)||void 0===t?void 0:t.map(e=>"> `".concat(e,"`")).join("\n"))&&void 0!==a?a:"","\n  \n\n  Can you fix this error in `").concat(r.artifactId,"`?"),g=i?{label:u.formatMessage({defaultMessage:"Try fixing with Claude",id:"wrcoZ2Zo0b"}),onClick:()=>{d(!0),null==i||i({prompt:m,attachments:[],files:[],syncSources:[]})},disabled:l,loading:c}:void 0;return(0,o.jsx)("div",{className:"absolute bottom-5 left-5 right-5",children:(0,o.jsx)(j,{title:h.title,description:h.description,handleClose:s,inset:(null===(n=h.inset)||void 0===n?void 0:n.length)?h.inset?(0,o.jsx)("ul",{children:h.inset.map((e,t)=>(0,o.jsx)("li",{children:e},t))}):null:void 0,action:g})})};var q=n(56065);let E="opacity-30 blur-[2px]",k=e=>{let{isOpen:t,content:n,language:a,citations:r,type:s,showRaw:i,richSandboxRef:d,isCurrentStreaming:h,isChatStreaming:m,onSandboxConfirmation:g,sendMessage:f,richSandboxCapabilities:x,isLatestVersion:y,artifactId:b,artifactVersion:v,onArtifactRuntimeError:C,artifact:S,hasMenuOpen:w,zoom:z,onTrackInteraction:R}=e,j=void 0!==s&&void 0!==n&&s!==c.JP.Code&&s!==c.JP.Markdown,k=(0,p.useRef)(null),F=j&&!i,[N,I]=(0,p.useState)(null),A=(0,p.useCallback)(e=>{void 0!==b&&void 0!==v&&(void 0!==C&&C(e),I({error:e,artifactId:b,artifactVersion:v}))},[b,v,C]);(0,p.useEffect)(()=>{var e;if(!S||!h)return;let t=S.versions[S.versions.length-1],n=S.versions[S.versions.length-2];if(!n||!t||"update"!==t.command)return;let o=O(n.resultState,t.resultState);-1!==o&&(null===(e=k.current)||void 0===e||e.scrollToPercentage(o/100))},[n,S,h]),(0,p.useEffect)(()=>{!h&&k.current&&k.current.enableScrolling()},[h]);let L=(0,p.useCallback)(()=>{I(e=>e&&(e.artifactId!==b||e.artifactVersion!==v)?null:e)},[b,v]),G=(0,p.useCallback)(()=>{I(null)},[]);return(0,o.jsxs)(o.Fragment,{children:[j&&(0,o.jsxs)("div",{className:(0,u.Z)("ease-out duration-200",F?"h-full w-full relative border-none":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none",w&&E),children:[(0,o.jsx)(q.e,{ref:d,className:F?"h-full w-full border-none bg-bg-100":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none",content:F?n:void 0,type:F?s:void 0,onSandboxConfirmation:g,capabilities:x,onReportError:A,onSetContent:L,onRefresh:G,externalLinkBehavior:"ask",zoom:z,onTrackInteraction:R}),F&&N&&(0,o.jsx)(M,{error:N,handleClose:()=>I(null),sendMessage:y?f:void 0,isStreaming:m})]}),void 0===n||void 0===s?null:s===c.JP.Code||i?(0,o.jsx)(l.l,{noDefaultScroll:!h,ref:k,className:(0,u.Z)("ease-out duration-200","relative flex w-full flex-1 overflow-x-auto overflow-y-scroll",w&&E),children:(0,o.jsx)(P,{content:n,isStreaming:m,language:a,sendMessage:f,isOpen:t},"code-".concat(b,"-").concat(v,"-").concat(h))}):s===c.JP.Markdown?(0,o.jsx)(l.l,{noDefaultScroll:!h,ref:k,className:(0,u.Z)("ease-out duration-200","relative flex w-full flex-1 overflow-x-auto overflow-y-scroll",w&&E),children:(0,o.jsx)(T,{content:n,citations:r,isStreaming:m,sendMessage:f,isOpen:t},"markdown-".concat(b,"-").concat(v,"-").concat(h))}):null]})},P=e=>{let{content:t,isStreaming:n,language:r,sendMessage:s,isOpen:l}=e,{codeStyle:c}=(0,i.o)();return(0,o.jsx)(w,{isStreaming:n,sendMessage:s,contentType:"code",isOpen:l,children:(0,o.jsx)(h.Z,{className:"code-block__code !my-0 h-fit min-h-full w-fit min-w-full !rounded-none !text-sm !leading-relaxed",language:r,PreTag:"div",style:c,renderer:a.S,children:t})})},T=e=>{let{content:t,citations:n,isStreaming:a,sendMessage:i,isOpen:l}=e,c=(0,d.X)(),u=(0,p.useMemo)(()=>c&&n&&n.length>0?(0,s.NM)(n,t):t,[t,n,c]);return(0,o.jsx)(w,{isStreaming:a,sendMessage:i,isOpen:l,children:(0,o.jsxs)("div",{tabIndex:0,id:"markdown-artifact",className:"font-claude-message mx-auto w-full max-w-3xl leading-[1.65rem] -tracking-[0.015em] px-6 pt-4 md:pt-6 md:px-11",children:[(0,o.jsx)(r.ux,{text:u,blockCitations:n,className:"!gap-3.5"}),(0,o.jsx)("div",{className:"h-8"})]})})},O=(e,t)=>{if(!e||!t)return -1;let n=e.replace(/\\n/g,"\n"),o=t.replace(/\\n/g,"\n"),a=[...n].findIndex((e,t)=>e!==o[t]);if(-1===a&&n.length===o.length)return -1;let r=(n.slice(0,-1===a?n.length:a).match(/\n/g)||[]).length,s=(n.match(/\n/g)||[]).length;return s?Math.round(r/s*100):-1}},56065:function(e,t,n){n.d(t,{e:function(){return v}});var o=n(27573),a=n(8392),r=n(8571),s=n(27218),i=n(70354),l=n(87033),c=n(45144),d=n(10607),u=n(64357),p=n(46272),h=n(7653),m=n(40950),g=n(45790),f=n(93558),x=n(90056),y=n(37584),b=n(17796);let v=(0,h.forwardRef)((e,t)=>{let{content:n,className:v,type:C,onSandboxConfirmation:S,capabilities:w,onReportError:z,onSetContent:R,onRefresh:j,externalLinkBehavior:M,onOpenExternalLinkRequest:q,onTrackInteraction:E,lazy:k=!0,zoom:P=1}=e,T=(0,m.Z)(),{userContentRendererUrl:O}=(0,r.mX)(),[F,N]=(0,h.useState)(!1),I=(0,h.useRef)(null),[A,L]=(0,h.useState)(null),{activeOrganization:G}=(0,s.t)(),{value:H}=(0,l.FL)("apps_use_turmeric"),[D,Z]=(0,h.useState)(0),_=e=>e>=100,{sendRequest:B,updatePermission:U}=function(e){let{iframeRef:t,allowedOrigin:n,onRateLimited:o=null,initialPermissions:a,onPermissionRequested:r,onCapabilityAction:s}=e,[i,l]=(0,h.useState)(null),c=(0,h.useRef)(a),[d,u]=(0,h.useState)(0);(0,h.useEffect)(()=>{if(!t.current&&d<20){let e=setTimeout(()=>{u(e=>e+1)},500);return()=>clearTimeout(e)}if(!t.current){console.warn("Max retries reached while waiting for iframe");return}let e=new b.i({iframe:t.current,allowedOrigin:n,onRateLimited:o,onPermissionRequested:async e=>{if(f.TD.includes(e)||"accepted"===c.current[e])return"accepted";let t=await r(e);return c.current={...c.current,[e]:t},t},onCapabilityAction:s});return l(e),()=>{e.cleanup()}},[t,n,c,o,r,s,d]);let p=(0,h.useCallback)(async(e,t)=>{if(i)return i.sendRequest(e,t);throw Error("Communicator not initialized")},[i]),m=(0,h.useCallback)(()=>{null==i||i.restartListening()},[i]),g=(0,h.useCallback)((e,t)=>{c.current={...c.current,[e]:t}},[]);return{sendRequest:null===i?void 0:p,restartListening:m,permissions:c.current,updatePermission:g}}({iframeRef:I,allowedOrigin:O,onCapabilityAction:(0,h.useCallback)(async(e,t)=>{if(e.method===f.to.ReadyForContent)return N(!0),null==S||S(),Promise.resolve();if(e.method===f.to.GetFile)return w&&w.getFile?Promise.resolve({"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse",value:await w.getFile(e.payload.key)}):Promise.reject();if(e.method===f.to.SendConversationMessage)return w&&w.sendMessage?(await w.sendMessage({prompt:e.payload.message,attachments:[],files:[],syncSources:[]}),Promise.resolve()):Promise.reject();if(e.method===f.to.ClaudeCompletion)return w&&w.claudeComplete?(Z(e=>e+1),Promise.resolve({"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse",completion:await w.claudeComplete(e.payload.prompt)})):Promise.reject();if(e.method===f.to.BroadcastContentSize)return Promise.resolve();if(e.method===f.to.OpenExternal){if("ask"===M)return L(e.payload.href),Promise.resolve();if("bubble"===M&&q)return q({href:e.payload.href}),Promise.resolve()}else if(e.method===f.to.ReportError)return null==z||z(e.payload.error),Promise.resolve();else if(e.method===f.to.TrackInteraction)return null==E||E(e.payload),Promise.resolve();else if(e.method===f.to.ProxyFetch)return(0,x.j)(e.payload,t,null==G?void 0:G.uuid);return Promise.reject()},[S,w,N,z,Z,M,q,E,null==G?void 0:G.uuid]),onPermissionRequested:(0,h.useCallback)(async e=>e===f.to.ClaudeCompletion&&_(D)?"denied":Promise.resolve("accepted"),[D]),initialPermissions:{}});(0,h.useEffect)(()=>{_(D)&&(U(f.to.ClaudeCompletion,"denied"),(0,c.uT)("Claude completion request limit hit."))},[D,U]);let J=(0,h.useCallback)(()=>{(0,c.uT)("Claude completion modal confirmed"),Z(0),U(f.to.ClaudeCompletion,"accepted")},[U]),K=(0,h.useCallback)(async()=>{let e=await (null==B?void 0:B(f.to.GetScreenshot,y.D7));if(null==e?void 0:e.screenshot){if(e.screenshot.length>10485760)throw Error(T.formatMessage({defaultMessage:"Screenshot too large",id:"ifBuzEbIz2"}));if(!/^data:image\/(png|jpeg|gif);base64,/.test(e.screenshot))throw Error(T.formatMessage({defaultMessage:"Invalid screenshot format",id:"KCmGxpLNuq"}));return e.screenshot}},[T,B]),Y=(0,h.useCallback)(async()=>{let e=await (null==B?void 0:B(f.to.CopyHtmlContent,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentRequest"}));return null==e?void 0:e.reportHTMLContent},[B]),W=(0,h.useCallback)(async()=>{let e=await (null==B?void 0:B(f.to.GetDOMSnapshot,y.D7));return(null==e?void 0:e.domSnapshot)||void 0},[B]);return(0,h.useEffect)(()=>{F&&n&&C&&(null==R||R(),null==B||B(f.to.SetContent,{content:n,type:C,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"}))},[n,B,C,F,R]),(0,h.useImperativeHandle)(t,()=>({refresh:()=>{null==j||j(),N(!1);let e=I.current;e&&(e.src="".concat(O).concat(z?"?errorReportingMode=parent":""))},getScreenshot:K,copyHtmlContent:Y,getDOMSnapshot:W})),(0,o.jsxs)("div",{className:(0,d.Z)("relative",v),children:[(0,o.jsx)("iframe",{ref:I,className:"h-full w-full",style:{zoom:P},sandbox:"allow-scripts allow-same-origin",title:T.formatMessage({defaultMessage:"Claude content",id:"/Ma3teJf9/"}),loading:k?"lazy":void 0,src:"".concat(O).concat(z?"?errorReportingMode=parent":""),allow:"fullscreen; clipboard-write"}),(0,o.jsx)(u.M,{children:!F&&(0,o.jsx)(p.E.div,{className:"bg-bg-100 absolute inset-0 z-10",initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeInOut"}})}),A?(0,o.jsx)(a.o,{isOpen:!!A,url:A,onClose:()=>L(null),onConfirm:()=>{A&&window.open(A,"_blank"),L(null)}}):null,H&&_(D)&&(0,o.jsx)("div",{className:"fixed inset-0 bg-always-black bg-opacity-50 flex items-center justify-center z-modal",children:(0,o.jsxs)("div",{className:"bg-bg-100 p-4 rounded shadow-lg",children:[(0,o.jsx)("p",{className:"text-fg-100 mb-4",children:(0,o.jsx)(g.Z,{defaultMessage:"Many requests made. Acknowledge that you’re still here to continue.",id:"kmh/1AmVcl"})}),(0,o.jsx)(i.z,{onClick:J,variant:"primary",children:(0,o.jsx)(g.Z,{defaultMessage:"I’m still here",id:"NwhjMfjigc"})})]})})]})});v.displayName="RichSandbox"},93558:function(e,t,n){n.d(t,{KX:function(){return h},O3:function(){return y},P2:function(){return f},TD:function(){return b},q2:function(){return x},to:function(){return a},vr:function(){return m}});var o,a,r=n(82083),s=n(41270),i=n(37584);(o=a||(a={})).ReadyForContent="anthropic.claude.usercontent.sandbox.ReadyForContent",o.SetContent="anthropic.claude.usercontent.sandbox.SetContent",o.GetFile="anthropic.claude.usercontent.sandbox.GetFile",o.SendConversationMessage="anthropic.claude.usercontent.sandbox.SendConversationMessage",o.RunCode="anthropic.claude.usercontent.sandbox.RunCode",o.ClaudeCompletion="anthropic.claude.usercontent.sandbox.ClaudeCompletion",o.ReportError="anthropic.claude.usercontent.sandbox.ReportError",o.GetScreenshot="anthropic.claude.usercontent.sandbox.GetScreenshot",o.BroadcastContentSize="anthropic.claude.usercontent.sandbox.BroadcastContentSize",o.OpenExternal="anthropic.claude.usercontent.sandbox.OpenExternal",o.CopyHtmlContent="anthropic.claude.usercontent.sandbox.CopyHtmlContent",o.TrackInteraction="anthropic.claude.usercontent.sandbox.TrackInteraction",o.ProxyFetch="anthropic.claude.usercontent.sandbox.ProxyFetch",o.ProxyFetchStream="anthropic.claude.usercontent.sandbox.ProxyFetchStream",o.GetDOMSnapshot="anthropic.claude.usercontent.sandbox.GetDOMSnapshot";let l=s.z.object({type:s.z.literal("UnsupportedImports"),unsupportedModules:s.z.array(s.z.string()),nonExistentIcons:s.z.array(s.z.string())}),c=s.z.object({type:s.z.literal("RuntimeError"),message:s.z.string()}),d=s.z.object({type:s.z.literal("FileNotFound"),fileName:s.z.string()}),u=s.z.object({type:s.z.literal("ClaudeCompletionError"),message:s.z.string()}),p=s.z.discriminatedUnion("type",[l,c,d,u]),h=s.z.object({code:s.z.string()}),m=s.z.object({status:s.z.enum(["success","error"]),result:s.z.string().optional(),logs:s.z.array(s.z.string()),error:s.z.string().optional()}),g={"anthropic.claude.usercontent.sandbox.CopyHtmlContent":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.CopyHtmlContent"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentResponse"),reportHTMLContent:s.z.string()})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.SetContent":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.SetContent"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"),content:s.z.string(),type:s.z.nativeEnum(r.JP),watchContentSize:s.z.boolean().optional()})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ReadyForContent":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ReadyForContent"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:i.AY,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.BroadcastContentSize":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.BroadcastContentSize"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.BroadcastContentSizePayload"),height:s.z.number(),width:s.z.number()})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.GetFile":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.GetFile"),payload:s.z.strictObject({key:s.z.string(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({value:s.z.instanceof(Uint8Array).nullable(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.SendConversationMessage":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.SendConversationMessage"),payload:s.z.strictObject({message:s.z.string(),messageType:s.z.enum(["text","error"]),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.SendConversationMessageRequest")})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.RunCode":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.RunCode"),payload:s.z.strictObject({code:s.z.string(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeResponse")}).merge(m)}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ClaudeCompletion":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ClaudeCompletion"),payload:s.z.strictObject({prompt:s.z.string(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({completion:s.z.string().nullable(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ReportError":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ReportError"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ReportErrorRequest"),error:p})}),responseSchema:i.AY,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.GetScreenshot":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.GetScreenshot"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({screenshot:s.z.string().nullable(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetScreenshotResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.OpenExternal":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.OpenExternal"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.OpenExternal"),href:s.z.string()})}),responseSchema:i.AY,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.TrackInteraction":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.TrackInteraction"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.TrackInteraction"),interactionType:s.z.literal("click")})}),responseSchema:i.AY,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.ProxyFetch":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ProxyFetch"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchRequest"),url:s.z.string(),method:s.z.string(),headers:s.z.record(s.z.string()),body:s.z.instanceof(ArrayBuffer).nullable(),channelId:s.z.string()})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchResponse"),status:s.z.number(),statusText:s.z.string(),headers:s.z.record(s.z.string())})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ProxyFetchStream":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ProxyFetchStream"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchStreamRequest"),channelId:s.z.string(),chunk:s.z.instanceof(ArrayBuffer).nullable(),done:s.z.boolean(),error:s.z.string().optional()})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.GetDOMSnapshot":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.GetDOMSnapshot"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetDOMSnapshotResponse"),domSnapshot:s.z.string().nullable()})}),alwaysPermitted:!1}},f=s.z.enum(["anthropic.claude.usercontent.sandbox.ReadyForContent","anthropic.claude.usercontent.sandbox.GetFile","anthropic.claude.usercontent.sandbox.SendConversationMessage","anthropic.claude.usercontent.sandbox.ClaudeCompletion","anthropic.claude.usercontent.sandbox.ReportError","anthropic.claude.usercontent.sandbox.BroadcastContentSize","anthropic.claude.usercontent.sandbox.OpenExternal","anthropic.claude.usercontent.sandbox.TrackInteraction","anthropic.claude.usercontent.sandbox.ProxyFetch"]),x=s.z.discriminatedUnion("method",[g["anthropic.claude.usercontent.sandbox.ReadyForContent"].requestSchema,g["anthropic.claude.usercontent.sandbox.GetFile"].requestSchema,g["anthropic.claude.usercontent.sandbox.SendConversationMessage"].requestSchema,g["anthropic.claude.usercontent.sandbox.ClaudeCompletion"].requestSchema,g["anthropic.claude.usercontent.sandbox.ReportError"].requestSchema,g["anthropic.claude.usercontent.sandbox.BroadcastContentSize"].requestSchema,g["anthropic.claude.usercontent.sandbox.OpenExternal"].requestSchema,g["anthropic.claude.usercontent.sandbox.TrackInteraction"].requestSchema,g["anthropic.claude.usercontent.sandbox.ProxyFetch"].requestSchema]);s.z.union([i.AY,g["anthropic.claude.usercontent.sandbox.GetFile"].responseSchema,g["anthropic.claude.usercontent.sandbox.SendConversationMessage"].responseSchema,g["anthropic.claude.usercontent.sandbox.ClaudeCompletion"].responseSchema,g["anthropic.claude.usercontent.sandbox.ProxyFetch"].responseSchema]),s.z.enum(["anthropic.claude.usercontent.sandbox.SetContent","anthropic.claude.usercontent.sandbox.RunCode","anthropic.claude.usercontent.sandbox.GetScreenshot","anthropic.claude.usercontent.sandbox.CopyHtmlContent","anthropic.claude.usercontent.sandbox.ProxyFetchStream","anthropic.claude.usercontent.sandbox.GetDOMSnapshot"]),s.z.discriminatedUnion("method",[g["anthropic.claude.usercontent.sandbox.SetContent"].requestSchema,g["anthropic.claude.usercontent.sandbox.RunCode"].requestSchema,g["anthropic.claude.usercontent.sandbox.GetScreenshot"].requestSchema,g["anthropic.claude.usercontent.sandbox.CopyHtmlContent"].requestSchema,g["anthropic.claude.usercontent.sandbox.ProxyFetchStream"].requestSchema,g["anthropic.claude.usercontent.sandbox.GetDOMSnapshot"].requestSchema]);let y=s.z.union([g["anthropic.claude.usercontent.sandbox.SetContent"].responseSchema,g["anthropic.claude.usercontent.sandbox.RunCode"].responseSchema,g["anthropic.claude.usercontent.sandbox.GetScreenshot"].responseSchema,g["anthropic.claude.usercontent.sandbox.CopyHtmlContent"].responseSchema,g["anthropic.claude.usercontent.sandbox.ProxyFetchStream"].responseSchema,g["anthropic.claude.usercontent.sandbox.GetDOMSnapshot"].responseSchema]),b=Object.entries(g).filter(e=>{let[t,n]=e;return!0===n.alwaysPermitted}).map(e=>{let[t,n]=e;return t})},90056:function(e,t,n){n.d(t,{j:function(){return i}});var o=n(93558);let a=new Set(["accept","accept-language","content-type","content-length"]),r=new Set(["set-cookie","x-api-key","x-auth-token","authorization"]),s={"api.anthropic.com":async(e,t)=>await fetch("/api/organizations/".concat(e,"/proxy/v1/messages"),t)};async function i(e,t,n){let o;let{url:i,method:c,headers:d,body:u,channelId:p}=e,h=new URL(i),m={};for(let[e,t]of Object.entries(d))a.has(e.toLowerCase())&&(m[e]=t);let g=new AbortController;if(h.hostname in s)o=await s[h.hostname](n||"",{method:c,headers:m,body:u||void 0,signal:g.signal,redirect:"manual"});else throw Error("Unable to proxy requests for ".concat(h.hostname,"."));let f={};return o.headers.forEach((e,t)=>{r.has(t.toLowerCase())||(f[t]=e)}),l(o,p,t),{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchResponse",status:o.status,statusText:o.statusText,headers:f}}async function l(e,t,n){var a;let r=null===(a=e.body)||void 0===a?void 0:a.getReader();if(!r){await n(o.to.ProxyFetchStream,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchStreamRequest",channelId:t,chunk:null,done:!0});return}let s=0;try{for(;;){let{done:e,value:a}=await r.read();if(e){await n(o.to.ProxyFetchStream,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchStreamRequest",channelId:t,chunk:null,done:!0});break}if(a){let e;if((s+=a.byteLength)>10485760)throw Error("Response body exceeds maximum size of ".concat(10485760," bytes"));let r=0===a.byteOffset&&a.byteLength===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength);e=r instanceof ArrayBuffer?r:new Uint8Array(r).slice().buffer,await n(o.to.ProxyFetchStream,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchStreamRequest",channelId:t,chunk:e,done:!1},[e])}}}catch(e){await n(o.to.ProxyFetchStream,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchStreamRequest",channelId:t,chunk:null,done:!1,error:e instanceof Error?e.message:"Unknown error"})}finally{r.releaseLock()}}},37584:function(e,t,n){n.d(t,{AY:function(){return l},D7:function(){return c},Kj:function(){return i},Tk:function(){return s},Zq:function(){return r},qV:function(){return a},v8:function(){return d}});var o=n(41270);let a=o.z.object({channel:o.z.enum(["request","response"]),requestId:o.z.string()}).passthrough(),r=a.strict().extend({channel:o.z.literal("request"),method:o.z.string(),payload:o.z.strictObject({"@type":o.z.string()})}),s=a.extend({channel:o.z.literal("response"),status:o.z.number().int().min(100).max(599),payload:o.z.strictObject({"@type":o.z.string()}).passthrough()}).passthrough(),i=s.extend({status:o.z.number().int().min(400).max(599),payload:o.z.strictObject({"@type":o.z.literal("type.googleapis.com/anthropic.claude.usercontent.ErrorResponse"),error:o.z.string()})}),l=s.extend({payload:o.z.strictObject({"@type":o.z.literal("type.googleapis.com/google.protobuf.Empty")})}),c={"@type":"type.googleapis.com/google.protobuf.Empty"},d=e=>({"@type":"type.googleapis.com/anthropic.claude.usercontent.ErrorResponse",error:e})},17796:function(e,t,n){n.d(t,{i:function(){return s}});var o=n(93558),a=n(37584);let r=new Map;class s{setupMessageListener(){window.addEventListener("message",this.boundHandleMessage,!1)}handleMessage(e){if(e.origin!==this.allowedOrigin||e.source!==this.iframe.contentWindow)return;let t=Date.now();if(t-this.lastResetTime>this.RESET_INTERVAL&&(this.messageCount=0,this.lastResetTime=t),this.messageCount++,this.messageCount>this.MAX_MESSAGES_PER_INTERVAL){window.removeEventListener("message",this.boundHandleMessage),this.onRateLimited&&this.onRateLimited();return}let n=a.qV.safeParse(e.data);if(!n.success){console.warn("Received message does not conform to basic message shape, ignoring");return}let o=n.data;if("response"===o.channel){this.handleResponse(o);return}this.messageQueue.push(o),this.isConsumerRunning||this.consumeMessages()}handleResponse(e){let t=this.inFlightRequests.get(e.requestId)||r.get(e.requestId);if(void 0!==t){t(e),r.delete(e.requestId);return}}async consumeMessages(){for(this.isConsumerRunning=!0;this.messageQueue.length>0;){let e=this.messageQueue.shift();if(!e)continue;let t=o.P2.safeParse(e.method);if(!t.success){this.sendErrorResponse(e.requestId,400,"Unknown method");continue}let n=t.data,r=o.q2.safeParse(e);if(!r.success){this.sendErrorResponse(e.requestId,400,"Invalid payload content");continue}let s=r.data;if(this.requestLog.has(s.requestId)){this.sendErrorResponse(s.requestId,400,"Request ID already processed");continue}this.requestLog.set(s.requestId,{message:s,requestTimestamp:new Date().getTime()}),await this.onPermissionRequested(n).then(e=>"denied"!==e||(this.sendErrorResponse(s.requestId,403,"Permission denied"),!1)).catch(e=>(console.error("Error checking permission for method ".concat(n,":"),e),this.sendErrorResponse(s.requestId,500,"Error checking permission"),!1))&&(this.onCapabilityAction(s,this.boundSendRequest).then(e=>{var t;let n=a.Tk.parse({channel:"response",status:200,requestId:s.requestId,payload:null!=e?e:a.D7}),o=this.requestLog.get(s.requestId);o&&this.requestLog.set(s.requestId,{...o,response:n,responseTimestamp:new Date().getTime()}),null===(t=this.iframe.contentWindow)||void 0===t||t.postMessage(n,this.allowedOrigin)}).catch(e=>{console.error("Error processing action for method ".concat(n,":"),e),this.sendErrorResponse(s.requestId,500,"Internal server error while processing action")}),await new Promise(e=>requestAnimationFrame(e)))}this.isConsumerRunning=!1}sendErrorResponse(e,t,n){var o;let r=a.Kj.parse({channel:"response",status:t,requestId:e,payload:(0,a.v8)(n)}),s=this.requestLog.get(e);s&&this.requestLog.set(e,{...s,response:r,responseTimestamp:new Date().getTime()}),null===(o=this.iframe.contentWindow)||void 0===o||o.postMessage(r,this.allowedOrigin)}restartListening(){window.removeEventListener("message",this.boundHandleMessage),this.messageCount=0,this.lastResetTime=Date.now(),this.setupMessageListener()}cleanup(){window.removeEventListener("message",this.boundHandleMessage),this.messageQueue=[],this.isConsumerRunning=!1,this.inFlightRequests.clear()}async sendRequest(e,t,n){return new Promise((s,i)=>{var l,c;let d=Date.now().toString(),u={channel:"request",method:e,requestId:d,payload:t},p=e=>{let t=a.Tk.safeParse(e);if(!t.success){i(Error("Invalid response format"));return}let n=t.data;if(n.status>=400){let e=a.Kj.safeParse(n);e.success?i(Error(e.data.payload.error)):i(Error("Error response (".concat(n.status,")")));return}let r=o.O3.safeParse(n);r.success?s(r.data.payload):i(Error("Invalid response payload for the method"))};this.inFlightRequests.set(d,p),r.set(d,p),n&&n.length>0?null===(l=this.iframe.contentWindow)||void 0===l||l.postMessage(u,this.allowedOrigin,n):null===(c=this.iframe.contentWindow)||void 0===c||c.postMessage(u,this.allowedOrigin)})}getRequestLog(){return Array.from(this.requestLog.entries()).map(e=>{let[t,n]=e;return{...n,requestId:t}}).sort((e,t)=>t.requestTimestamp-e.requestTimestamp)}constructor({iframe:e,allowedOrigin:t,onRateLimited:n=null,onPermissionRequested:o,onCapabilityAction:a}){this.messageCount=0,this.lastResetTime=Date.now(),this.MAX_MESSAGES_PER_INTERVAL=30,this.RESET_INTERVAL=5e3,this.onRateLimited=null,this.messageQueue=[],this.isConsumerRunning=!1,this.requestLog=new Map,this.inFlightRequests=new Map,this.iframe=e,this.allowedOrigin=t,this.onRateLimited=n,this.onPermissionRequested=o,this.onCapabilityAction=a,this.boundHandleMessage=this.handleMessage.bind(this),this.boundSendRequest=this.sendRequest.bind(this),this.setupMessageListener()}}},84575:function(e,t,n){n.d(t,{w:function(){return s}});var o=n(27573),a=n(32737),r=n(10607);function s(e){let{Icon:t,children:n,isAssistant:s=!0,tooltipContent:i,...l}=e;return(0,o.jsx)(a.u,{className:"mt-1",side:"bottom",delayDuration:100,tooltipContent:i,children:(0,o.jsxs)("button",{...l,className:(0,r.Z)("flex flex-row items-center gap-1.5 rounded-md p-2 text-sm transition text-text-300 active:scale-95","select-auto",s?"hover:bg-bg-300 py-1.5":"hover:bg-bg-500 py-1",l.className),children:[t&&(0,o.jsx)(t,{size:16}),n]})})}n(7653)},39527:function(e,t,n){n.d(t,{l:function(){return r}});var o=n(27573),a=n(7653);let r=(0,a.forwardRef)((e,t)=>{let{className:n,children:r,disabled:s,noDefaultScroll:i}=e,l=(0,a.useRef)(0),c=(0,a.useRef)(!0),d=(0,a.useRef)(null),u=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";if(d.current&&c.current){if(d.current.scrollHeight-d.current.clientHeight<d.current.scrollTop)return;if(d.current&&"function"==typeof d.current.scrollTo){var t,n,o;null===(o=d.current)||void 0===o||o.scrollTo({top:(null===(t=d.current)||void 0===t?void 0:t.scrollHeight)-(null===(n=d.current)||void 0===n?void 0:n.clientHeight)+5,behavior:e})}}},[]),p=(0,a.useCallback)(e=>{if(d.current&&d.current&&"function"==typeof d.current.scrollTo){var t,n,o;d.current.style.overflow="hidden",null===(o=d.current)||void 0===o||o.scrollTo({top:(null===(t=d.current)||void 0===t?void 0:t.scrollHeight)*e-(null===(n=d.current)||void 0===n?void 0:n.clientHeight)/2,behavior:"auto"})}},[]),h=(0,a.useCallback)(()=>{d.current&&(d.current.style.overflow="")},[]);return(0,a.useImperativeHandle)(t,()=>({reset(){l.current=0,c.current=!0,i||u()},scrollToBottomIfPinned:u,scrollToPercentage:p,enableScrolling:h}),[u,p,h,i]),(0,a.useLayoutEffect)(()=>{s||!r||i||u()},[r,s,u,i]),(0,o.jsx)("div",{className:n,onScroll:e=>{if(s)return;let t=e.currentTarget.scrollTop,n=function(e,t){if(!e)return!1;{let n=e.scrollHeight-8;return Math.ceil(t+e.offsetHeight)>=Math.floor(n)}}(d.current,t),o=t>l.current;n&&o?c.current=!0:n||o||(c.current=!1),l.current=t},ref:d,children:r})});r.displayName="AutoScroll"}}]);